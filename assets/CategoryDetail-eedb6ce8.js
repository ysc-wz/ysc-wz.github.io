import{ay as $,ax as q,r as c,c as x,h as R,k as j,ag as p,aq as F,y as i,z as y,A as s,M as r,I as G,O as H,a4 as K,P as z,G as m,H as g,L as f,K as S,V as O}from"./vue-vendor-91321e54.js";import{_ as J,a as w}from"./index-25df5040.js";import{E as _}from"./element-plus-f833f9f1.js";const Q={class:"category-detail"},W={class:"category-header"},X={class:"description"},Y={class:"car-grid"},Z={class:"car-image-wrapper"},ee=["src","alt"],te={class:"car-tags"},ae={class:"car-info"},se={class:"car-specs"},oe={class:"car-price"},re={class:"price"},ne={class:"pagination"},ie={__name:"CategoryDetail",setup(le){const v=$(),D=q(),l=c(1),d=c(12),h=c(0),C=c([]),k=x(()=>{const e={sedan:{title:"轿车专区",description:"优雅与舒适的完美结合"},suv:{title:"SUV专区",description:"为探索而生的多功能座驾"},sports:{title:"跑车专区",description:"激情与速度的完美融合"},electric:{title:"新能源专区",description:"驱动未来的绿色出行选择"},hybrid:{title:"混动车型",description:"节能环保的智慧之选"},mpv:{title:"MPV专区",description:"舒适实用的家庭之选"},pickup:{title:"皮卡专区",description:"多功能实用的工作伙伴"},supercar:{title:"豪华超跑",description:"极致性能与奢华的完美融合"},luxury:{title:"豪华车型",description:"尊贵品质的精致座驾"},offroad:{title:"越野车型",description:"无惧挑战的探险之选"}},t=v.params.category;return console.log("当前分类:",t),e[t]||{title:"全部车型",description:"为您精选优质车源"}}),u=async()=>{n.value=!0;try{const t={category:v.params.category,page:l.value,pageSize:d.value};console.log("发送请求，参数:",t);const{data:o}=await w.get("/api/cars",{params:t});o&&Array.isArray(o.items)?(C.value=o.items,h.value=o.total||0):(console.error("返回数据格式不正确:",o),_.warning("数据格式不正确"))}catch(e){console.error("获取车辆数据失败:",e),_.error("获取车辆数据失败，请稍后重试")}finally{n.value=!1}},P=e=>{d.value=e,u()},V=e=>{l.value=e,u()},M=e=>(e==null?void 0:e.toLocaleString())||"0",b=e=>e?e.split(",")[0]:"/images/default-car.jpg",I=e=>{D.push(`/car/${e}`)},n=c(!1),N=async e=>{if(!n.value)try{n.value=!0,await w.post("/api/cart",{carId:e.id,quantity:1}),_.success("已加入购物车")}catch(t){console.error("加入购物车失败:",t),_.error("加入购物车失败，请稍后重试")}finally{n.value=!1}};R(()=>v.params.category,(e,t)=>{e!==t&&(console.log("分类改变:",e),l.value=1,u())},{immediate:!0});const B=x(()=>C.value);return j(()=>{u()}),(e,t)=>{const o=p("el-tag"),A=p("el-button"),E=p("el-card"),L=p("el-pagination"),T=F("loading");return i(),y("div",Q,[s("div",W,[s("h1",null,r(k.value.title),1),s("p",X,r(k.value.description),1)]),G((i(),y("div",Y,[(i(!0),y(H,null,K(B.value,a=>(i(),m(E,{key:a.id,class:"car-card",onClick:U=>I(a.id)},{default:g(()=>[s("div",Z,[s("img",{src:b(a.images),alt:a.model},null,8,ee),s("div",te,[a.stock<=3?(i(),m(o,{key:0,type:"danger"},{default:g(()=>t[2]||(t[2]=[f("库存紧张")])),_:1})):S("",!0),a.isNew?(i(),m(o,{key:1,type:"success"},{default:g(()=>t[3]||(t[3]=[f("新上市")])),_:1})):S("",!0)])]),s("div",ae,[s("h3",null,r(a.brand)+" "+r(a.model),1),s("p",se,[s("span",null,r(a.year)+"年",1),s("span",null,r(a.mileage)+"公里",1),s("span",null,r(a.color),1)]),s("div",oe,[s("span",re,"¥"+r(M(a.price)),1),z(A,{type:"primary",onClick:O(U=>N(a),["stop"])},{default:g(()=>t[4]||(t[4]=[f(" 加入购物车 ")])),_:2},1032,["onClick"])])])]),_:2},1032,["onClick"]))),128))])),[[T,n.value]]),s("div",ne,[z(L,{currentPage:l.value,"onUpdate:currentPage":t[0]||(t[0]=a=>l.value=a),pageSize:d.value,"onUpdate:pageSize":t[1]||(t[1]=a=>d.value=a),total:h.value,"page-sizes":[12,24,36,48],layout:"total, sizes, prev, pager, next",onSizeChange:P,onCurrentChange:V,background:""},null,8,["currentPage","pageSize","total"])])])}}},pe=J(ie,[["__scopeId","data-v-ff7f8959"]]);export{pe as default};
